"use strict";(function(){this.ajaxCartSuccess=function(t,e){window.omegaCallBackAddToCart&&"function"==typeof window.omegaCallBackAddToCart&&window.omegaCallBackAddToCart(),window.fetch(this.routes.cart_url+"?section_id=ecom-ajax-cart"+(t&&t.key?"&key="+t.key:""),{method:"GET",headers:{"Content-Type":"text/html"}}).then(t=>t.text()).then(e=>{let o=document.querySelector(".ecom-cart-popup"),n=document.createElement("div");n.classList.add("ecom-cart-popup");const a=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-ecom-ajax-cart");if(!a)return window.location.href=this.routes.cart_url,!1;if(n.appendChild(a),document.body.appendChild(n),this.handleCartPopup(n),t&&t.key){let e=n.querySelector('.ecom-ajax-cart-line-item[data-key="'+t.key+'"]');e&&this.blinkElement(e)}o&&o.remove(),this.onAjaxPopupLoaded()}).catch(t=>{console.log(t),alert(t.message)})},this.onAjaxPopupLoaded=()=>{},this.blinkElement=function(t){t.classList.add("ecom-line-item-blink"),setTimeout(()=>{t&&t.classList.remove("ecom-line-item-blink")},2e3)},this.recentProducts=function(){if(window.location.pathname.indexOf("/products/")>=0){var t=window.location.pathname.split("/products/").pop().split("/")[0];try{var e=JSON.parse(window.localStorage.getItem("ecom-recent-products"));if("object"!=typeof e)throw"Data invalid";if(e.indexOf(t)>=0)return 0;e.reverse(),e.push(t),e.reverse(),window.localStorage.setItem("ecom-recent-products",JSON.stringify(e))}catch(t){window.localStorage.setItem("ecom-recent-products","[]")}}},this.handleCartPopup=function(t){var e=this;function o(t){"minus"===this.name?(this.nextElementSibling.stepDown(),this.nextElementSibling.dispatchEvent(new window.Event("change"))):"plus"===this.name&&(this.previousElementSibling.stepUp(),this.previousElementSibling.dispatchEvent(new window.Event("change")))}function n(){let t=this.value,o=this.dataset.key,n=this.closest(".ecom-ajax-cart-line-item");n&&n.classList.add("ecom-item-loading"),e.cartItemChange(o,parseInt(t)).then(t=>{let a=t.items.find(t=>t.key===o);a?e.ajaxCartSuccess(a):e.ajaxCartSuccess(),n&&n.classList.remove("ecom-item-loading")}).catch(t=>{window.alert(t.message),console.error(t),e.ajaxCartError(t)})}t.addEventListener("click",(function(e){if(e.target===t)t.remove();else{e.target.closest('[data-ecom-action="close"]')&&t.remove()}})),t.querySelectorAll(".ecom-ajax-cart-line-item-quantity-button").forEach(t=>{t.addEventListener("click",o)}),t.querySelectorAll(".ecom-ajax-cart-line-item-quantity-input").forEach(t=>{t.addEventListener("change",n)}),t.querySelector("#ecom-ajax-cart-note")&&t.querySelector("#ecom-ajax-cart-note").addEventListener("change",(function(){let t=this.value;e.cartUpdate({note:t})})),t.querySelectorAll(".ecom-ajax-cart-line-item-button-remove").forEach(t=>{t.addEventListener("click",(function(t){t.preventDefault(),this.value=0,n.bind(this)(t)}))})},this.ajaxCartError=function(t,e){alert("Error"+t.message)},this.beforeAjaxCartSend=function(t){},this.ajaxCart=function(){var t=t=>{if(t.preventDefault(),!t.target.querySelector('[name="id"]'))return!!window.document.querySelector("#admin-bar-iframe")&&(alert('Please drag Variant picker element to this section to allow the "Add to cart" feature working. This message only show for owner\'s store'),!1);const e=t.target.querySelector(".ecom-product-single__add-to-cart--submit");e&&(e.style.cursor="not-allowed",e.style.pointerEvents="none",e.classList.add("ecom-ajax-loading","ecom-loading")),this.beforeAjaxCartSend(t.target);let o=new FormData(t.target);return o.append("sections","cart-notification-product,cart-notification-button,cart-icon-bubble"),window.fetch(this.routes.cart_add_url,{method:"POST",headers:{Accept:"application/json"},body:o}).then(t=>t.json()).then(o=>{if(o.errors)throw new Error(o.errors);let{action:n,href:a,textAddedCart:i,target:r,messageAddedCart:c}=e.dataset;switch(e&&(e.style.cursor="pointer",e.style.pointerEvents="auto",e.classList.remove("ecom-ajax-loading","ecom-loading"),e.querySelector(".ecom-add-to-cart-text")&&(e.querySelector(".ecom-add-to-cart-text").innerHTML=i)),this.onAjaxCartSuccess&&this.onAjaxCartSuccess(o,t.target),n){case"cart":return window.location.href=this.routes.cart_url;case"reload":return window.location.reload();case"checkout":return window.location.href=this.routes.root_url+("/"===this.routes.root_url?"":"/")+"checkout";case"message":this.showToast(c);break;case"link":if(a)return"_blank"===r?window.open(a):window.location.href=a;default:this.ajaxCartSuccess(o,t.target)}}).catch(o=>{e&&(e.style.cursor="pointer",e.style.pointerEvents="auto",e.classList.remove("ecom-ajax-loading","ecom-loading")),this.ajaxCartError(o,t.target)}),!1};document.body.addEventListener("submit",(function(e){if(e.target.classList.contains("ecom-product-form")&&"FORM"===e.target.nodeName)return e.preventDefault(),t.bind(this)(e),!1})),this.handleATCList();let e=document.querySelectorAll(".ecom-ajax-cart-simple[data-id]");var o=this;e.forEach((function(t){t.addEventListener("click",(function(t){o.handleClickEvent(this,t)}))}))},this.handleClickEvent=function(t,e,o=!1){e.preventDefault();const n=t,a=this;n&&(n.style.cursor="pointer",n.style.pointerEvents="auto",n.classList.add("ecom-ajax-loading")),a.beforeAjaxCartSend(e.target),window.fetch(a.routes.cart_add_url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:n.dataset.id,quantity:1})}).then(t=>t.json()).then(t=>{if(t.errors)throw new Error(t.errors);let{action:i,href:r,textAddedCart:c,target:s,messageAddedCart:l}=n.dataset;if(n&&(n.style.cursor="pointer",n.style.pointerEvents="auto",n.classList.remove("ecom-ajax-loading","ecom-loading"),n.querySelector(".ecom-add-to-cart-text").innerHTML=c),a.onAjaxCartSuccess&&a.onAjaxCartSuccess(t,e.target),o&&!a.configs.ajax_cart.enable)return window.location.href=a.routes.cart_url;switch(i){case"cart":return window.location.href=a.routes.cart_url;case"checkout":return window.location.href=a.routes.root_url+"checkout";case"message":a.showToast(l);break;case"link":if(r)return"_blank"===s?window.open(r):window.location.href=r;default:a.ajaxCartSuccess(t,e.target)}}).catch(t=>{window.alert(t.message),console.error(t),n&&(n.style.cursor="pointer",n.style.pointerEvents="auto",n.classList.remove("ecom-ajax-loading","ecom-loading")),a.ajaxCartError(t,e.target)})},this.cartItemChange=function(t,e){return window.fetch(this.routes.cart_change_url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:t,quantity:e})}).then(t=>t.json())},this.handleATCList=function(){let t=document.querySelectorAll(".ecom-collection__product-item .ecom-product-form");var e=this;t.forEach((function(t){let o=t.querySelector(".ecom-ajax-cart-submit"),n=t.querySelector('[name="variant_id"]');o&&n&&o.addEventListener("click",(function(t){t.preventDefault(),this.dataset.id=n.value,e.handleClickEvent(this,t,!0)})),t.classList.add("ecom-ajax-cart")}))},this.cartUpdate=function(t,e){return window.fetch(this.routes.cart_update_url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(t=>t.json())},this.showToast=function(t){let e=document.querySelector("#ecom-toast-desc"),o=document.querySelector("#ecom-toast");o&&e&&(e.innerHTML=t,o.classList.add("ecom-toast-show"),o.style.setProperty("--ecom-max-width",e.clientWidth+50+"px"),setTimeout(()=>{o.classList.remove("ecom-toast-show")},5e3))},this.initToastTemplate=function(){let t=document.querySelector("#ecom-template-html");if(t){let e=document.createElement("div");e.innerHTML=t.innerHTML,document.body.appendChild(e)}},this.init=function(){this.initToastTemplate(),this.configs&&this.configs.ajax_cart&&this.configs.ajax_cart.enable?this.ajaxCart():(this.handleATCList(),document.body.addEventListener("submit",(function(t){t.target.classList.contains("ecom-product-form")&&"FORM"===t.target.nodeName&&window.omegaCallBackAddToCart&&"function"==typeof window.omegaCallBackAddToCart&&window.omegaCallBackAddToCart()})))},this.init()}).bind(window.EComposer||{})(),function(){var t;function e(){document.querySelectorAll(".ecom-sections .ecom-video-background").forEach((function(t){"true"===t.dataset.playPauseInview&&(!function(t){const{top:e,bottom:o}=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight;return(e>0||o>0)&&e<n}(t)?t.pause():t.play())}))}function o(){clearTimeout(window.stretchedTimmer),window.stretchedTimmer=setTimeout(()=>{let t=document.querySelectorAll(".ecom-core.ecom-section"),e=document.querySelectorAll(".ecom-swiper-container"),o=document.querySelectorAll(".ecom-sections"),n=window.innerWidth;if(t.length>0){o.forEach(t=>{t.style.width=""});let e=(n-o[0].offsetWidth)/2;t.forEach(t=>{t.classList.contains("ecom-section__stretched")?(t.style.width=n+"px",t.style.marginLeft=-e+"px"):(t.style.width="",t.style.marginLeft="")})}e.length>0&&e.forEach(t=>{t.EComSwiper&&t.EComSwiper.update()})},50)}window.addEventListener("scroll",(function(){clearTimeout(t),t=setTimeout(e,500)})),o(),window.addEventListener("resize",o),window.addEventListener("load",o),document.addEventListener("DOMContentLoaded",(function(){"function"==typeof window.EComposer.initQuickview&&window.EComposer.initQuickview()})),function(t,e={}){let o=document.querySelectorAll(t);(o=Array.from(o)).forEach(t=>{!function(t,e){new IntersectionObserver((o,n)=>{o.forEach(o=>{o.isIntersecting&&(e.cb?e.cb(t):(o.target.classList.add("ecom-animated"),o.target.classList.add("animated")),n.unobserve(o.target))})},e).observe(t)}(t,e)})}(".ecom-animation");(function(){const t=this;this.init=function(){const e=document.querySelectorAll("[ecom-scrolling-animation]");e.length&&window.addEventListener("scroll",()=>{t.handleScrollAnimation(e)})},this.handleScrollAnimation=function(e){e.forEach((function(e){t.animation(e)}))},this.animation=function(t){const e=t.getAttribute("ecom-scrolling-animation")?JSON.parse(t.getAttribute("ecom-scrolling-animation")):null;if(!e)return;const o=this.getViewPercentage(t);if(o>0&&o<100){const i=this.getOptions(e,o);var n="",a="";Object.keys(i).forEach((function(t){["translateX","translateY","rotate"].includes(t)?(n+=`${t}(${i[t]})`,delete i[t]):["blur"].includes(t)&&(a+=`${t}(${i[t]})`,delete i[t])})),Object.keys(i).length&&Object.assign(t.style,i),n&&(t.style.transform=n),a&&(t.style.filter=a)}},this.getOptions=function(e,o){var n={};return e.forEach((function(e){const a=e.value;if(a){var i;if(a.trigger_start||a.trigger_end){let e=a.trigger_start?a.trigger_start:0,n=a.trigger_end?a.trigger_end:100;if(e>n){let t=e;e=n,n=t}if(e<=o&&n>=o){var r=(o-e)/(n-e)*100;i=t.caculateCss(r,a)}}else i=t.caculateCss(o,a);n[e.css]=i}})),n},this.caculateCss=function(t,e){let o="";if(e.hasOwnProperty("start")&&e.hasOwnProperty("end")){if(e.hasOwnProperty("middle")){var n=this.toInt(e.start),a=this.toInt(e.middle),i=this.toInt(e.end);o=t<=50?n-(o=(n-a)*(t/100/.5)):a+(o=(a-i)*(1-t/100/.5))}else{o=(this.toInt(e.start)-this.toInt(e.end))*(t/100),o=this.toInt(e.start)-o}return o+this.getUnit(e.start)}if(e.middle&&50===t)return this.toInt(e.middle)+this.getUnit(e.middle)},this.toInt=function(t){return"number"==typeof t?t:parseInt(t.replace("px",""))},this.getUnit=function(t){return"number"==typeof t?"":t.replace(/-?([\d]+)/,"")},this.getViewPercentage=function(t){const e=t.getBoundingClientRect(),o=window.innerHeight;return(window.scrollY+o-(e.y+window.pageYOffset))/((o+e.height)/100)},this.init()}).bind({}).call()}();